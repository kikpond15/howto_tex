% emathOld.sty ver0.04 2005/09/08 by tDB (emath@nifty.com)
%
\RequirePackage{emathEy}
\RequirePackage{emathMw}
\RequirePackage{emathLb}
\RequirePackage{emathCap}
\@ifundefined{zahyou}{}{%
	\RequirePackage{emathPb}
	\RequirePackage{emathPg}
}%
%
% edaMon
%
\newcounter{edaban}[enumi]%

\def\ow@ri@s{ow@ri@s}%
\def\pre@edaMon{\par}
\newcommand{\syouMonLabel}{\edaMonLabel}%
\newcommand{\edaMonLabel}[1]{\def\edaMonLabel@s{#1}}%
\newcommand{\preedaMon}[1]{\def\pre@edaMon{#1}}%
\def\edaMonLabel@s{(\roman{edaban})\ }%

\def\edaMon{%
    \@ifnextchar[{\@edaMon@}{\@edaMon@[2]}%
    }%
\def\@edaMon@[#1]{%
    \@ifnextchar({\@edaMon[#1]}{\@edaMon[#1](0pt)}%
    }%
\def\@edaMon[#1](#2){%
    \@ifnextchar"{\@@edaMon[#1](#2)}{\@@edaMon[#1](#2)"ow@ri@s"}%
    }%
\def\@@edaMon[#1](#2)"#3"{%
    \@ifnextchar"{\@@@edaMon[#1](#2)"#3"}{\@@@edaMon[#1](#2)"#3""ow@ri@s"}%
    }%
\def\@@@edaMon[#1](#2)"#3""#4"{%
    \@ifnextchar"{\@@@@edaMon[#1](#2)"#3""#4"}%
    {\@@@@edaMon[#1](#2)"#3""#4""ow@ri@s"}%
    }%
\def\@@@@edaMon[#1](#2)"#3""#4""#5"{%
    \@ifnextchar"{\@@@@@edaMon[#1](#2)"#3""#4""#5"}%
    {\@@@@@edaMon[#1](#2)"#3""#4""#5""ow@ri@s"}%
    }%
\def\@@@@@edaMon[#1](#2)"#3""#4""#5""#6"{%
    \@ifnextchar"{\@@@@@@edaMon[#1](#2)"#3""#4""#5""#6"}%
    {\@@@@@@edaMon[#1](#2)"#3""#4""#5""#6""ow@ri@s"}%
    }%
\def\@@@@@@edaMon[#1](#2)"#3""#4""#5""#6""#7"{%
    \pre@edaMon
    \ifdim#2>0pt%
        \templa=#2%
    \else
        \templa=\linewidth%
        \addtolength{\templa}{-\columnsep}%
        \divide\templa by #1%
    \fi%
    \def\tmp{#3}%
    \ifx\tmp\ow@ri@s\else\edaMon@sub%
    \def\tmp{#4}%
    \ifx\tmp\ow@ri@s\else\edaMon@sub%
    \def\tmp{#5}%
    \ifx\tmp\ow@ri@s\else\edaMon@sub%
    \def\tmp{#6}%
    \ifx\tmp\ow@ri@s\else\edaMon@sub%
    \def\tmp{#7}%
    \ifx\tmp\ow@ri@s\else\edaMon@sub%
    \fi\fi\fi\fi\fi%
    }%
\def\edaMon@sub{%
        \begin{minipage}[t]{\templa}\stepcounter{edaban}\edaMonLabel@s%
        \tmp\end{minipage}%
    }%

%%%
%%% 部分的二段組
%%%
%\newdimen\nidanmigihaba
\newdimen\nidansep
\newdimen\nidanseprule
\setlength{\nidansep}{2pt}%
\newsavebox{\nidan@boxi}%
\newsavebox{\nidan@boxii}%

\def\nidan{\@ifnextchar<{\nidan@}{\nidan@<r>}}%
\def\nidan@<#1>{\@ifnextchar<{\nidan@@<#1>}{\nidan@@<#1><\z@>}}%
\def\nidan@@<#1><#2>{\@ifnextchar({\@nidan<#1><#2>}{\@nidan<#1><#2>(\empty)}}%
\def\@nidan<#1><#2>(#3){\@ifnextchar[{\@@nidan<#1><#2>(#3)}{%
  \@@nidan<#1><#2>(#3)[t]}}%
\def\@@nidan<#1><#2>(#3)[#4]{\@ifnextchar[{\@@@nidan<#1><#2>(#3)[#4]}{%
  \@@@nidan<#1><#2>(#3)[#4][t]}}%
\long\def\@@@nidan<#1><#2>(#3)[#4][#5]#6#7{%
%   #1 : l|r 図の位置 t|y|z 右段の縦組/横組指定（デフォルトは r）
%   #2 : #1=t の場合の minipage のサイズ
%   #3 : そのまま実行します．
%   #4 : 左段 minipage の配置オプション
%   #5 : 右段 〃
%   #6 : 右段の横巾
%   #7 : 右段
  \par
% \setlength{\nidanmigihaba}{#3}%
  \noindent
  #3\relax%
  \ifthenelse{\equal{#1}{l}}{\edef\fig@placement{l}}{\edef\fig@placement{r}}%
  \setlength{\templa}{\linewidth}%
  \setlength{\templb}{#6}%
  \addtolength{\templa}{-\templb}%
  \addtolength{\templa}{-\nidansep}%
  \addtolength{\templa}{-\nidansep}%
  \addtolength{\templa}{-\nidanseprule}%
  \global\setbox\nidan@boxii=\hbox{%
    \ifx l#1\begin{minipage}[#5]{\templb}\dmyln #7\end{minipage}\else%
    \ifx r#1\begin{minipage}[#5]{\templb}\dmyln #7\end{minipage}\else%
    \begin{minipage}<#1>[#5]{#2}\dmyln #7\end{minipage}\fi\fi
  }%
  \global\setbox\nidan@boxi=\hbox\bgroup%
  \begin{minipage}[#4]{\templa}\setlength{\parindent}{1zw}}%

\def\endnidan{\end{minipage}\egroup\noindent
  \if r\fig@placement\box\nidan@boxi\else
    \raisebox{.5\baselineskip}{\box\nidan@boxii}\fi
  \hspace{\nidansep}\vrule width \nidanseprule\hspace{\nidansep}%
  \if r\fig@placement\raisebox{.5\baselineskip}{\box\nidan@boxii}\else
    \box\nidan@boxi\fi
  \vskip\topsep\vskip\parskip\endtrivlist}%

% list 環境下における図の回り込み
%
% \Nidan[#1]#2#3
%   #1 : 回り込み行数
%   #2 : 図の横幅
%   #3 : 図
%

%\edef\ND@lvl{0}%
\def\Nidan{\@ifstar{\Nidan@}{\@Nidan}}
\def\@Nidan{\@ifnextchar[{\@@Nidan}{\@@Nidan[\empty]}}
\long\def\@@Nidan[#1]#2#3{\mbox{}%
%
\global\let\ND@par\par
\long\def\par{\ND@par
  \xISub\ND@gyousuu{\the\prevgraf}\ND@gyousuu
  \ifnum\ND@gyousuu>\z@
    \edef\zu@shape{\ND@gyousuu}%
    \if r\@lr
      \Cfor{\edef\zu@i{1}}{\zu@i<\ND@gyousuu}{\Incr\zu@i}\do{%
        \edefappend\zu@shape{ \@totalleftmargin \@tempdima}}%
      \edefappend\zu@shape{ \@totalleftmargin \linewidth}%
    \else
      \@tempdimb\@totalleftmargin\advance\@tempdimb\nidan@zuhaba
      \advance\@tempdimb\nidansep\advance\@tempdimb\nidansep
      \Cfor{\edef\zu@i{1}}{\zu@i<\ND@gyousuu}{\Incr\zu@i}\do{%
        \edefappend\zu@shape{ \@tempdimb \@tempdima}}%
      \edefappend\zu@shape{ \@totalleftmargin \linewidth}%
    \fi
    \if l\@lr\mbox{}\vspace{-\baselineskip}\par\fi
    \parshape\zu@shape
  \else
    \parshape 1 \@totalleftmargin \linewidth
  \fi
  \ignorespaces}%
%\xIncr\ND@lvl
  \IFempty{#2}{}{\xdef\nidan@zuhaba{#2}}%
  \@tempdima\linewidth\advance\@tempdima-\nidan@zuhaba\relax
  \@tempdimc\@tempdima
  \advance\@tempdima-\nidansep\advance\@tempdima-\nidansep
  \setbox0=\hbox{\begin{minipage}{\nidan@zuhaba}#3\end{minipage}}%
\headchar{#1}\@lr\ND@@gyousuu
\edef\ND@tyouseigyou{0}%
\ifthenelse{\equal\@lr{+}}{\edef\ND@tyouseigyou{\ND@@gyousuu}%
    \edef\@lr{r}\edef\ND@@gyousuu{\empty}}{%
  \ifthenelse{\equal\@lr{-}}{\edef\ND@tyouseigyou{#1}%
    \edef\@lr{r}\edef\ND@@gyousuu{\empty}}{%
  \ifthenelse{\equal{\@lr}{l}}{}{\edef\@lr{r}\edef\ND@@gyousuu{#1}}}}%
 \ifx \ND@@gyousuu\empty
    \@tempdimb\ht0\advance\@tempdimb\dp0\relax
    \Div{\strip@pt\@tempdimb}{\strip@pt\baselineskip}\ND@gyousuu@
    \strsep\ND@gyousuu@{.}\ND@gyousuu\@tmp
    \IAdd\ND@gyousuu\ND@tyouseigyou\ND@gyousuu
    \xIncr[2]\ND@gyousuu
  \else
  \edef\ND@gyousuu{\ND@@gyousuu}\xIncr\ND@gyousuu
  \fi
  \unitlength1pt%
  \@tempdimb\ht0\advance\@tempdimb\dp0\advance\@tempdimb-1zh\relax
\vrule height \z@ depth \@tempdimb width\z@
{\advance\@tempdimb 1.4zh\relax
\vspace{-\@tempdimb}\ND@par}%
\if r\@lr
  \begin{picture}(0,0)%
    \put(\strip@pt\@tempdimc,-\strip@pt\@tempdimb){\makebox(0,0)[lb]{\box0}}%
  \end{picture}%
\else
  \begin{picture}(0,0)%
    \put(0,-\strip@pt\@tempdimb){\makebox(0,0)[lb]{\box0}}%
  \end{picture}%
\fi
  \edef\zu@shape{\ND@gyousuu}%
  \if r\@lr
    \Cfor{\edef\zu@i{1}}{\zu@i<\ND@gyousuu}{\Incr\zu@i}\do{%
      \edefappend\zu@shape{ \@totalleftmargin \@tempdima}}%
    \edefappend\zu@shape{ \@totalleftmargin \linewidth}%
  \else
    \@tempdimb\@totalleftmargin\advance\@tempdimb\nidan@zuhaba
    \advance\@tempdimb\nidansep\advance\@tempdimb\nidansep
    \Cfor{\edef\zu@i{1}}{\zu@i<\ND@gyousuu}{\Incr\zu@i}\do{%
      \edefappend\zu@shape{ \@tempdimb \@tempdima}}%
    \edefappend\zu@shape{ \@totalleftmargin \linewidth}%
  \fi
  \if l\@lr\mbox{}\vspace{-\baselineskip}\par\fi
  \parshape\zu@shape
  \ignorespaces}
\def\endNidan{%\xDecr\ND@lvl
  \par\parshape 1\@totalleftmargin \linewidth}

% 右空けの継続
\expandafter\def\csname Nidan*\endcsname{%
  \@ifnextchar[{\@cNidan}{\@cNidan[\empty]}}
\def\@cNidan[#1]{%
\ifnum\ND@gyousuu>\z@
 \long\def\par{%
  \ltx@par
  \xISub\ND@gyousuu{\the\prevgraf}\ND@gyousuu
  \ifnum\ND@gyousuu>\z@
    \edef\zu@shape{\ND@gyousuu}%
    \if r\@lr
      \Cfor{\edef\zu@i{1}}{\zu@i<\ND@gyousuu}{\Incr\zu@i}\do{%
        \edefappend\zu@shape{ \@totalleftmargin \@tempdima}}%
      \edefappend\zu@shape{ \@totalleftmargin \linewidth}%
    \else
      \@tempdimb\@totalleftmargin\advance\@tempdimb\nidan@zuhaba
      \advance\@tempdimb\nidansep\advance\@tempdimb\nidansep
      \Cfor{\edef\zu@i{1}}{\zu@i<\ND@gyousuu}{\Incr\zu@i}\do{%
        \edefappend\zu@shape{ \@tempdimb \@tempdima}}%
      \edefappend\zu@shape{ \@totalleftmargin \linewidth}%
    \fi
    \if l\@lr\mbox{}\vspace{-\baselineskip}\par\fi
    \parshape\zu@shape
  \else
    \parshape 1 \@totalleftmargin \linewidth
  \fi
  \ignorespaces}%
%
  \@tempdima\linewidth\advance\@tempdima-\nidan@zuhaba\relax
  \@tempdimc\@tempdima
  \advance\@tempdima-\nidansep\advance\@tempdima-\nidansep
  \setbox0=\hbox{}
\headchar{#1}\@lr\ND@@gyousuu
\ifthenelse{\equal{\@lr}{l}}{}{\edef\@lr{r}\edef\ND@@gyousuu{#1}}%
 \ifx \ND@@gyousuu\empty\else
 \edef\ND@gyousuu{\ND@@gyousuu}\xIncr\ND@gyousuu\fi
  \edef\zu@shape{\ND@gyousuu}%
  \if r\@lr
    \Cfor{\edef\zu@i{1}}{\zu@i<\ND@gyousuu}{\Incr\zu@i}\do{%
      \edefappend\zu@shape{ \@totalleftmargin \@tempdima}}%
    \edefappend\zu@shape{ \@totalleftmargin \linewidth}%
  \else
    \@tempdimb\@totalleftmargin\advance\@tempdimb\nidan@zuhaba
    \advance\@tempdimb\nidansep\advance\@tempdimb\nidansep
    \Cfor{\edef\zu@i{1}}{\zu@i<\ND@gyousuu}{\Incr\zu@i}\do{%
      \edefappend\zu@shape{ \@tempdimb \@tempdima}}%
    \edefappend\zu@shape{ \@totalleftmargin \linewidth}%
  \fi
  \if l\@lr\mbox{}\vspace{-\baselineskip}\par\fi
  \parshape\zu@shape
  \ignorespaces\fi
%  \xIncr\ND@lvl
}

\expandafter\def\csname endNidan*\endcsname{\endNidan}

%%% 乙部 pLaTeX2e for Windows Another Manual Vol.1   p.226
\newcommand{\tabtopsp}[1]{\vbox{\vbox to #1{}\vbox to1zw{}}}

\endinput


ver 0.01 nidan, Nidan
ver 0.02 \tabtopsep
ver 0.04 emathEy.sty emathMw.sty 独立対策
